<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>User Page</title>
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='styles.css') }}">
</head>
<body>
    <header class="navbar">
        <span style="font-size:30px;cursor:pointer" onclick="openSidePanel()">&#9776;</span>
        <div class="banner-section">
            <span class="retro-font">Retro Ideal</span>
            <p class="cursive-font">{{ first_name }}</p>
        </div>
        <button onclick="logout()" class="logout-btn">Logout</button>
    </header>
    <div class="side-panel" id="sidePanel">
        <a href="javascript:void(0)" class="close-btn" onclick="closeSidePanel()">&times;</a>
        <h1>Vehicles</h1>
        {% for vehicle in vehicles %}
            <div class="vehicle-item">
                <a href="#" onclick="loadVehicleDetails({{ loop.index }})">{{ vehicle.reg }}</a>
                <button class="add-button" onclick="addVehicle({{ loop.index }})">+</button>
            </div>
        {% endfor %}
    </div>    
    <div class="content" id="contentArea">
        <!-- Existing content -->
        <h2>Selected Vehicle Details</h2>
        <div id="vehicleDetails">
            <!-- Details for the selected vehicle will be populated here -->
        </div>
        <div id="imageGallery">
            <!-- Image gallery for the selected vehicle will be displayed here -->
        </div>
    </div>
    <div class="footer">
        &copy; 2023 Your Company
    </div>

    <!-- Script to handle side panel open/close -->
    <script>
        const vehicles = {{ vehicles | tojson | safe }};
        const vehicle_images = {{ vehicle_images | tojson | safe }};
        function openSidePanel() {
            document.getElementById("sidePanel").style.width = "200px"; // Adjust the width as needed
        }

        function closeSidePanel() {
            document.getElementById("sidePanel").style.width = "0";
        }

        console.log('Vehicles:', vehicles); // Output the vehicles array to the console for debugging
    
        function loadVehicleDetails(index) {
        const selectedVehicle = vehicles[index - 1];
        const detailsContainer = document.getElementById('vehicleDetails');
        const galleryContainer = document.getElementById('imageGallery');

        const detailsHTML = `
            <h2>Details for ${selectedVehicle.reg}</h2>
            <p>VIN: ${selectedVehicle.vin}</p>
            <p>Make: ${selectedVehicle.make}</p>
            <p>Model: ${selectedVehicle.model}</p>
            <!-- Add more details as needed -->
        `;
        detailsContainer.innerHTML = detailsHTML;

        // Filter vehicle images for the selected vehicle
        const selectedVehicleImages = vehicle_images.filter(image => image['vehicle-id'] === selectedVehicle.vh_id);

        let galleryHTML = '<h2>Image Gallery</h2><div class="gallery">';

        selectedVehicleImages.forEach(image => {
            galleryHTML += `
                <img src="${image['image-url']}" alt="${image['filename']}" class="gallery-image">
                <!-- You can add more image details if needed -->
            `;
        });
        galleryHTML += '</div>';
        galleryContainer.innerHTML = galleryHTML;
    }
    
    function addVehicle(index) {
    const selectedVehicle = vehicles[index - 1];
    const contentArea = document.querySelector('.content');

    // Construct the HTML to display the vehicle details
    const detailsHTML = `
        <h2>Details for ${selectedVehicle.reg}</h2>
        <div class="vehicle-details">
            <h3>Selected Vehicle Details</h3>
            <p>Registration: ${selectedVehicle.reg}</p>
            <p>VIN: ${selectedVehicle.vin}</p>
            <p>Make: ${selectedVehicle.make}</p>
            <p>Model: ${selectedVehicle.model}</p>
            <!-- Add more details as needed -->
        </div>
        <div class="file-upload-panel">
            <h3>Upload File</h3>
            <form method="POST" enctype="multipart/form-data" id="uploadForm">
                <input type="file" id="fileInput" name="fileInput">
                <button type="submit">Upload</button>
            </form>
        </div>
        <div id="uploadGallery" class="image-gallery">
            <!-- Gallery view for uploaded files goes here -->
        </div>
    `;

    // Display the vehicle details in the content area
    contentArea.innerHTML = detailsHTML;
}


function uploadFile() {
    // Function to handle file upload
    const fileInput = document.getElementById('fileInput');
    const uploadGallery = document.getElementById('uploadGallery');

    // Perform file upload actions, e.g., display uploaded images
    // For demonstration purposes, let's assume there's an array of uploaded images
    const uploadedImages = [
        'image1.jpg',
        'image2.jpg',
        'image3.jpg'
        // ... add more images as needed
    ];

    // Display uploaded images in the gallery
    let galleryHTML = '<h3>Uploaded Images</h3><div class="gallery">';

    uploadedImages.forEach(image => {
        galleryHTML += `
            <img src="${image}" alt="Uploaded Image" class="gallery-image">
        `;
    });
    galleryHTML += '</div>';
    uploadGallery.innerHTML = galleryHTML;
}



    </script>
</body>
</html>
